Q1: The progression of (average) daily traffic volume over the years

SELECT DayOfWeek, count(*) AS n FROM ontime WHERE YearD BETWEEN 2000 AND 2008 GROUP BY DayOfWeek ORDER BY c DESC;

Q2: Flight departure delays by day of the week

SELECT DayOfWeek, count(*) AS n FROM ontime WHERE DepDelay>10 AND YearD BETWEEN 2000 AND 2008 GROUP BY DayOfWeek ORDER BY c DESC;

Q3: Airports with the most flight departure delays

SELECT Origin, count(*) AS n FROM ontime WHERE DepDelay>10 AND YearD BETWEEN 2000 AND 2008 GROUP BY Origin ORDER BY c DESC LIMIT 10;

Q4: Flight departure delays in 2007 by carrier

SELECT carrier, count(*) FROM ontime WHERE DepDelay>10 AND YearD=2007 GROUP BY carrier ORDER BY 2 DESC;

Q5: Flight delay percentage in 2007 by carrier

WITH t AS (SELECT carrier, count(*) AS n FROM ontime WHERE DepDelay>10 AND YearD=2007 GROUP BY carrier), t2 AS (SELECT carrier, count(*) AS n2 FROM ontime WHERE YearD=2007 GROUP BY carrier) SELECT t.carrier, c, c2, c*1000/c2 as c3 FROM t JOIN t2 ON (t.Carrier=t2.Carrier) ORDER BY c3 DESC;

Q6: Flight delay percentage by carrier and year

WITH t AS (SELECT carrier, count(*) AS n FROM ontime WHERE DepDelay>10 AND YearD>=2000 AND YearD<=2008 GROUP BY carrier), t2 AS (SELECT carrier, count(*) AS n2 FROM ontime WHERE YearD>=2000 AND YearD<=2008 GROUP BY carrier) SELECT t.carrier, c, c2, c*1000/c2 as c3 FROM t JOIN t2 ON (t.Carrier=t2.Carrier) ORDER BY c3 DESC;

Q7: Flight delay percentage by year

WITH t AS (SELECt year_,count(*)*1000 AS n1 from ontime WHERE DepDelay>10 GROUP BY YearD), t2 AS (select year_,count(*) AS n2 FROM ontime GROUP BY year_) SELECT t.year_, c1/c2 FROM t JOIN t2 ON (t.year_=t2.year_);

Q8: Destinations available from the most cities over the course of several years (you may wish to alter the first and last years in the range)

SELECT DestCityName, COUNT( DISTINCT OriginCityName) FROM ontime WHERE Year BETWEEN 2003 and 2007 GROUP BY DestCityName ORDER BY 2 DESC LIMIT 10;

Q9: Number of flight records by year

SELECT year_, count(*) as n FROM ontime GROUP BY year_;
